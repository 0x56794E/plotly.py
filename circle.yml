machine:
  python:
    version: 2.7
  environment:
    PLOTLY_CONFIG_DIR: ~/.plotly
    PLOTLY_VENV_DIR: ~/venvs
    PLOTLY_PYTHON_VERSIONS: ( 3.4 ) # ( 2.6 2.7 3.3 3.4 )
    PLOTLY_CORE_REQUIREMENTS_FILE: ${PWD}/requirements.txt
    PLOTLY_OPTIONAL_REQUIREMENTS_FILE: ${PWD}/optional-requirements.txt
    PLOTLY_OPTIONAL_REQUIREMENTS_FILE_2_6: ${PWD}/optional-requirements-2-6.txt
dependencies:
  pre:
    # run all the pre-written installers (this will take a *while*)
    - bash circle/setup.sh
    # install testing tools for circle's version of things
    - pip install nose coverage
  override:
    - pip install -I .
  cache_directories:
    # things we don't want to have to do again...
    - ${PLOTLY_VENV_DIR}
test:
  override:

    # test that it imports when you don't have file permissions
    - chmod 000 ${PLOTLY_CONFIG_DIR} && python -c "import plotly"

    # test that setting permissions will work for import (and tests)
    - chmod 600 ${PLOTLY_CONFIG_DIR} && python -c "import plotly"

    # test core things in the general 2.7 version that circle has
    - nosetests -xv plotly/tests/test_core

    # run test suite in all our python versions
    - bash circle/test.sh
